(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{32:function(e,t,n){e.exports=n(60)},37:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),i=n(28),r=n.n(i),s=(n(37),n(9)),c=n(10),u=n(12),l=n(11),d=n(31),v=n(7),p=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).player=a.a.createRef(),o.state={video_url:o.props.src},o}return Object(c.a)(n,[{key:"render",value:function(){return a.a.createElement("video",{className:"video-js vjs-big-play-centered","data-setup":"{}",ref:this.player})}},{key:"componentDidUpdate",value:function(e,t){this.props.src!==e.src&&(this.setState({video_url:this.props.src}),console.log(this.video.sources))}},{key:"componentDidMount",value:function(){var e=this,t=this.player.current;this.video=window.videojs(t,{sources:[{src:this.state.video_url,type:"video/webm"}],controls:!0,fluid:!0}),console.log(this.props);var n=this.props.eventON;n&&Object.keys(n).forEach((function(t){e.video.on(t,(function(){n[t]()}))}))}},{key:"componentWillUnmount",value:function(){this.video&&this.video.dispose()}}]),n}(o.Component),m=n(15),f=n.n(m),h=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).getCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){var a=n[o].trim();if(0===a.indexOf(t))return a.substring(t.length,a.length)}return""},o.setCookie=function(e){var t=new Date;t.setTime(t.getTime()+2592e6);var n="expires="+t.toGMTString(),a=(new Date).getTime();document.cookie=e+"="+String(a)+"; "+n,o.setState({userID:n})},o.videoPlay=function(){o.updateEvents({type:"play",process:o.ITManPlayer.video.currentTime()}),o.ITManPlayer.video.play(),o.audioplayer.play()},o.videoPause=function(){o.updateEvents({type:"pause",process:o.ITManPlayer.video.currentTime()}),o.ITManPlayer.video.pause(),o.audioplayer.pause()},o.videoSeek=function(){o.audioplayer.currentTime=o.ITManPlayer.video.currentTime(),o.ITManPlayer.video.paused()||o.audioplayer.play()},o.volumechange=function(){o.audioplayer.volume=o.ITManPlayer.video.volume(),o.audioplayer.muted=o.ITManPlayer.video.muted()},o.videoWait=function(){o.updateEvents({type:"wait",process:o.ITManPlayer.video.currentTime()}),o.audioplayer.pause()},o.videoContinue=function(){o.updateEvents({type:"buffer complete",process:o.ITManPlayer.video.currentTime()}),o.ITManPlayer.video.paused()||o.audioplayer.play()},o.updateEvents=function(e){var t={};t.actionType=e.type,t.time=(new Date).getTime(),t.process=e.process,console.log(t),o.setState({events:[].concat(Object(d.a)(o.state.events),[t])})},o.sendLog=function(){f.a.post("http://204.44.88.11:6543/",{data:o.state.events,userID:o.state.userID},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))},o.state={video_url:"",audio_url:"",loaded:!1,fetchcount:0,events:[]},o.fetchVideo=o.fetchVideo.bind(Object(v.a)(o)),o.updateEvents=o.updateEvents.bind(Object(v.a)(o)),o.getCookie=o.getCookie.bind(Object(v.a)(o)),o.setCookie=o.setCookie.bind(Object(v.a)(o)),o.sendLog=o.sendLog.bind(Object(v.a)(o)),o}return Object(c.a)(n,[{key:"fetchVideo",value:function(){var e=this;if(1!=this.state.loaded){var t="http://localhost:4000/mitm/download/".concat(this.props.match.params.ix,".json");f.a.get(t).then((function(t){console.log(t.data);var n=t.data;console.log(n);var o=n.v,a=n.a;o&&a&&(e.setState({audio_url:a,video_url:o,loaded:!0}),clearTimeout(e.state.timeoutId),clearInterval(e.state.interrvalId))})).catch((function(e){console.log(e)}))}}},{key:"componentDidMount",value:function(){var e=this.getCookie("mitm");e?this.setState({userID:e}):this.setCookie("mitm");var t=setInterval(this.fetchVideo,2e3);this.setState({interrvalId:t});var n=setTimeout((function(){alert("Source not found")}),3e4);this.setState({timeoutId:n})}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.interrvalId),this.sendLog()}},{key:"render",value:function(){var e=this;return""!==this.state.video_url&&""!==this.state.audio_url?a.a.createElement("div",{className:"wrap"},a.a.createElement(p,{ref:function(t){return e.ITManPlayer=t},src:this.state.video_url,eventON:{pause:function(){console.log("Pause"),e.videoPause()},play:function(){console.log("Play"),e.videoPlay()},seeked:function(){e.videoSeek(),console.log("Seeked")},volumechange:function(){e.volumechange(),console.log("volumechange")},waiting:function(){console.log("buffering"),e.videoWait()},canPlay:function(){console.log("buffer complete"),e.videoContinue()}}}),a.a.createElement("audio",{ref:function(t){return e.audioplayer=t},src:this.state.audio_url,type:"audo/mp4"})):a.a.createElement("div",null,a.a.createElement("h1",null,"Loading"))}}]),n}(o.Component),y=n(29),g=n(1),b=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return console.log("/mitm-frontend"),a.a.createElement(y.a,{basename:"/mitm-frontend"},a.a.createElement(g.c,null,a.a.createElement(g.a,{path:"/video/:ix",render:function(e){return a.a.createElement(h,Object.assign({key:e.match.params.ix},e))}})))}}]),n}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[32,1,2]]]);
//# sourceMappingURL=main.21335a0d.chunk.js.map